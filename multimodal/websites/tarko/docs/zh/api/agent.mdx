---
title: Agent API
description: Complete API reference for @tarko/agent
---

# @tarko/agent

## ç®€ä»‹

`@tarko/agent` æ˜¯ä¸€ä¸ªäº‹ä»¶æµé©±åŠ¨çš„å…ƒ Agent æ¡†æ¶ï¼Œä¸“ä¸ºæ„å»ºé«˜æ•ˆçš„å¤šæ¨¡æ€ AI Agent è€Œè®¾è®¡ã€‚å®ƒæä¾›äº†å®Œæ•´çš„ Agent ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€å·¥å…·é›†æˆå’Œå¤šæ¨¡å‹æ”¯æŒã€‚

## ä½•æ—¶ä½¿ç”¨ï¼Ÿ

æ­¤ Agent SDK æä¾›äº†ä½çº§åˆ«çš„ç¼–ç¨‹ APIï¼Œé€‚ç”¨äºä»å¤´æ„å»º AI Agentï¼š

- **MCP Agent**: è¿æ¥åˆ° MCP å®¢æˆ·ç«¯ï¼Œå®ç°æ ‡å‡†åŒ–çš„ AI å·¥å…·åè®®
- **GUI Agent**: æ„å»ºå›¾å½¢ç•Œé¢ Agentï¼Œå¤„ç†ç”¨æˆ·äº¤äº’
- **è‡ªå®šä¹‰ Agent**: ä¸ºç‰¹å®šé¢†åŸŸæ„å»ºä¸“é—¨çš„ Agentï¼Œå¦‚ä»£ç ç”Ÿæˆã€æ•°æ®åˆ†æç­‰

ä¸é«˜çº§æ¡†æ¶ä¸åŒï¼Œ`@tarko/agent` ç»™ä½ å®Œå…¨çš„æ§åˆ¶æƒæ¥å®šåˆ¶ Agent è¡Œä¸ºã€‚

## æ¶æ„æ¦‚è§ˆ

```mermaid
graph TD
    A[ç”¨æˆ·è¾“å…¥] --> B[Agent.run()]
    B --> C[æ¶ˆæ¯å†å²ç®¡ç†]
    C --> D[LLM è¯·æ±‚]
    D --> E{éœ€è¦å·¥å…·è°ƒç”¨?}
    E -->|æ˜¯| F[å·¥å…·æ‰§è¡Œ]
    E -->|å¦| G[ç”Ÿæˆå›å¤]
    F --> H[å·¥å…·ç»“æœ]
    H --> I{è¾¾åˆ°æœ€å¤§è¿­ä»£?}
    I -->|å¦| D
    I -->|æ˜¯| G
    G --> J[äº‹ä»¶æµè¾“å‡º]
    
    K[äº‹ä»¶æµ] --> L[å®æ—¶ UI æ›´æ–°]
    K --> M[æ—¥å¿—è®°å½•]
    K --> N[æ€§èƒ½ç›‘æ§]
    
    style A fill:#e1f5fe
    style G fill:#c8e6c9
    style F fill:#fff3e0
    style K fill:#f3e5f5
```

## å®‰è£…

```bash
npm install @tarko/agent
```

## æ ¸å¿ƒç‰¹æ€§

### ğŸ”§ å·¥å…·é›†æˆ
åœ¨ Agent å“åº”ä¸­è½»æ¾åˆ›å»ºå’Œè°ƒç”¨å·¥å…·ï¼Œæ”¯æŒå¤æ‚çš„å¤šæ­¥éª¤å·¥ä½œæµã€‚

### ğŸ“¡ äº‹ä»¶æµé©±åŠ¨
åŸºäºæ ‡å‡†äº‹ä»¶æµåè®®ï¼Œå®æ—¶è¿½è¸ª Agent çŠ¶æ€ï¼Œé«˜æ•ˆæ„å»ºä¸Šä¸‹æ–‡å’Œ UIã€‚

### âš¡ åŸç”Ÿæµå¼
åŸç”Ÿæµå¼ä¼ è¾“è®©ä½ å®æ—¶äº†è§£ Agent çš„æ€è€ƒè¿‡ç¨‹å’Œè¾“å‡ºç»“æœã€‚

### ğŸ¯ å¤šæ¨¡æ€åˆ†æ
è‡ªåŠ¨åˆ†æå¤šæ¨¡æ€å·¥å…·ç»“æœï¼ˆå›¾åƒã€æ–‡æœ¬ã€æ–‡ä»¶ç­‰ï¼‰ï¼Œè®©ä½ ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚

### ğŸ”Œ å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›
ä¸°å¯Œçš„ç”Ÿå‘½å‘¨æœŸé’©å­è®¾è®¡ï¼Œå…è®¸ä½ å®ç°æ›´é«˜çº§çš„ Agent è¡Œä¸ºã€‚

### ğŸŒ å¤šæ¨¡å‹æä¾›å•†
æ”¯æŒ OpenAIã€Claudeã€è±†åŒ…ç­‰å¤šç§æ¨¡å‹ï¼Œæ”¯æŒé«˜çº§é…ç½®å’Œè¿è¡Œæ—¶åˆ‡æ¢ã€‚

### âš™ï¸ å¤šå·¥å…·è°ƒç”¨å¼•æ“
- `native`: OpenAI å…¼å®¹çš„åŸç”Ÿå‡½æ•°è°ƒç”¨
- `prompt_engineering`: åŸºäºæç¤ºçš„å·¥å…·è°ƒç”¨
- `structured_outputs`: JSON Schema ç»“æ„åŒ–è¾“å‡º

## å¿«é€Ÿå¼€å§‹

åˆ›å»º `index.ts`ï¼š

```ts
import { Agent, Tool, z, LogLevel } from '@tarko/agent';

const locationTool = new Tool({
  id: 'getCurrentLocation',
  description: "è·å–ç”¨æˆ·å½“å‰ä½ç½®",
  parameters: z.object({}),
  function: async () => {
    return { location: 'Boston' };
  },
});

const weatherTool = new Tool({
  id: 'getWeather',
  description: 'è·å–æŒ‡å®šä½ç½®çš„å¤©æ°”ä¿¡æ¯',
  parameters: z.object({
    location: z.string().describe('ä½ç½®åç§°ï¼Œå¦‚åŸå¸‚å'),
  }),
  function: async (input) => {
    const { location } = input;
    return {
      location,
      temperature: '70Â°F (21Â°C)',
      condition: 'Sunny',
      precipitation: '10%',
      humidity: '45%',
      wind: '5 mph',
    };
  },
});

const agent = new Agent({
  model: {
    provider: 'openai',
    id: 'gpt-4o',
    apiKey: process.env.OPENAI_API_KEY!, // ä»ç¯å¢ƒå˜é‡è·å–
  },
  tools: [locationTool, weatherTool],
  instructions: 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å¤©æ°”åŠ©æ‰‹ï¼Œèƒ½å¤Ÿè·å–å‡†ç¡®çš„ä½ç½®å’Œå¤©æ°”ä¿¡æ¯ã€‚',
  temperature: 0.7,
  maxIterations: 50,
});

async function main() {
  const response = await agent.run({
    input: "ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ",
  });
  console.log(response);
}

main();
```

æ‰§è¡Œï¼š

```bash
npx tsx index.ts
```

è¾“å‡ºï¼š

```json
{
  "id": "5c38c0a1-ccbe-48f0-8b97-ae78a4d9407e",
  "type": "assistant_message",
  "timestamp": 1750188571248,
  "content": "æ³¢å£«é¡¿ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ¸©åº¦ä¸º 70Â°F (21Â°C)ã€‚é™æ°´æ¦‚ç‡ä¸º 10%ï¼Œæ¹¿åº¦ä¸º 45%ï¼Œé£é€Ÿä¸º 5 mphã€‚",
  "finishReason": "stop",
  "messageId": "msg_1750188570877_ics24k3x"
}
```

## API

### Agent

å®šä¹‰ `Agent` å®ä¾‹ï¼š

```ts
const agent = new Agent({
  /* AgentOptions */
});
```

#### Agent é€‰é¡¹

åŸºäºæºç ä¸­å®é™…çš„ `AgentOptions` æ¥å£ï¼Œæ‰€æœ‰é€‰é¡¹éƒ½æ˜¯å¯é€‰çš„ï¼š

##### åŸºç¡€é…ç½®
- `id`: Agent å®ä¾‹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆé»˜è®¤: `"@tarko/agent"`ï¼‰
- `name`: Agent åç§°ï¼Œç”¨äºè¿½è¸ªå’Œæ—¥å¿—ï¼ˆé»˜è®¤: `"Anonymous"`ï¼‰
- `instructions`: Agent çš„ç³»ç»Ÿæç¤ºï¼Œå®Œå…¨æ›¿æ¢é»˜è®¤æç¤ºï¼ˆé»˜è®¤: å†…ç½®æ™ºèƒ½åŠ©æ‰‹æç¤ºï¼‰

##### æ¨¡å‹é…ç½®
- `model`: æ¨¡å‹é…ç½®å¯¹è±¡ï¼ŒåŒ…å« `provider`ã€`id`ã€`apiKey` ç­‰
- `temperature`: LLM æ¸©åº¦ï¼Œæ§åˆ¶è¾“å‡ºéšæœºæ€§ï¼ˆé»˜è®¤: `0.7`ï¼‰
- `top_p`: æ ¸é‡‡æ ·å‚æ•°ï¼Œæ§åˆ¶è¯æ±‡é€‰æ‹©å¤šæ ·æ€§ï¼ˆé»˜è®¤: æ¨¡å‹é»˜è®¤å€¼ï¼‰
- `maxTokens`: æ¯æ¬¡è¯·æ±‚çš„ Token é™åˆ¶ï¼ˆé»˜è®¤: `1000`ï¼‰
- `thinking`: æ¨ç†å†…å®¹æ§åˆ¶é€‰é¡¹

##### å·¥å…·é…ç½®
- `tools`: Agent å¯ç”¨çš„å·¥å…·æ•°ç»„
- `tool`: å·¥å…·è¿‡æ»¤é€‰é¡¹ï¼Œæ”¯æŒ `include`/`exclude` æ¨¡å¼
- `toolCallEngine`: å·¥å…·è°ƒç”¨å¼•æ“ç±»å‹ï¼ˆé»˜è®¤: `'native'`ï¼‰
  - `'native'`: OpenAI å…¼å®¹çš„åŸç”Ÿå‡½æ•°è°ƒç”¨
  - `'prompt_engineering'`: åŸºäºæç¤ºçš„å·¥å…·è°ƒç”¨
  - `'structured_outputs'`: JSON Schema ç»“æ„åŒ–è¾“å‡º

##### æ‰§è¡Œæ§åˆ¶
- `maxIterations`: æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼ˆé»˜è®¤: `1000`ï¼‰
- `context`: ä¸Šä¸‹æ–‡æ„ŸçŸ¥é€‰é¡¹ï¼Œå¦‚ `maxImagesCount`

##### è°ƒè¯•å’Œç›‘æ§
- `logLevel`: æ—¥å¿—çº§åˆ«ï¼ˆ`LogLevel.DEBUG`ã€`LogLevel.INFO` ç­‰ï¼‰
- `metric`: æ€§èƒ½æŒ‡æ ‡æ”¶é›†é…ç½®
- `enableStreamingToolCallEvents`: æ˜¯å¦å¯ç”¨æµå¼å·¥å…·è°ƒç”¨äº‹ä»¶ï¼ˆé»˜è®¤: `false`ï¼‰

##### é«˜çº§é€‰é¡¹
- `workspace`: æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„å·¥ä½œç›®å½•
- `sandboxUrl`: æ²™ç®±ç¯å¢ƒ URL
- `eventStreamOptions`: äº‹ä»¶æµå¤„ç†å™¨é…ç½®
- `initialEvents`: åˆå§‹åŒ–æ—¶æ¢å¤çš„äº‹ä»¶æ•°ç»„

### Tool

å®šä¹‰ `Tool` å®ä¾‹ï¼š

```ts
import { Tool, z } from '@tarko/agent';

const locationTool = new Tool({
  id: 'getCurrentLocation',
  description: "è·å–ç”¨æˆ·å½“å‰ä½ç½®",
  parameters: z.object({}),
  function: async () => {
    return { location: 'Boston' };
  },
});
```

#### Tool é€‰é¡¹

- `id`: å·¥å…·çš„å”¯ä¸€æ ‡è¯†ç¬¦
- `description`: å·¥å…·åŠŸèƒ½æè¿°
- `parameters`: å·¥å…·å‚æ•°çš„ Zod æ¨¡å¼
- `function`: å®ç°å·¥å…·é€»è¾‘çš„å¼‚æ­¥å‡½æ•°

## æŒ‡å—

### æµå¼æ¨¡å¼

åœ¨ä¸Šé¢çš„åŸºç¡€ç¤ºä¾‹ä¸­ï¼Œå¦‚æœå¯ç”¨ `stream: true`ï¼š

```ts
async function main() {
  const stream = await agent.run({
    input: "ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ",
    stream: true,
  });

  for await (const chunk of stream) {
    console.log(JSON.stringify(chunk));
  }
}
```

æ‚¨å°†è·å¾—åŒ…å«ä¸åŒäº‹ä»¶ç±»å‹çš„æµå¼è¾“å‡ºï¼š

- `assistant_message`: å®Œæ•´çš„åŠ©æ‰‹æ¶ˆæ¯
- `tool_call`: å·¥å…·æ‰§è¡Œäº‹ä»¶
- `tool_result`: å·¥å…·æ‰§è¡Œç»“æœ
- `assistant_streaming_message`: æµå¼æ¶ˆæ¯å—

### äº‹ä»¶ç±»å‹

#### AssistantMessage

```ts
interface AssistantMessage {
  id: string;
  type: 'assistant_message';
  timestamp: number;
  content: string;
  toolCalls?: ToolCall[];
  finishReason: 'stop' | 'tool_calls' | 'length';
  messageId: string;
}
```

#### ToolCall

```ts
interface ToolCallEvent {
  id: string;
  type: 'tool_call';
  timestamp: number;
  toolCallId: string;
  name: string;
  arguments: any;
  startTime: number;
  tool: ToolDefinition;
}
```

#### ToolResult

```ts
interface ToolResult {
  id: string;
  type: 'tool_result';
  timestamp: number;
  toolCallId: string;
  name: string;
  content: any;
  elapsedMs: number;
}
```

#### StreamingMessage

```ts
interface StreamingMessage {
  id: string;
  type: 'assistant_streaming_message';
  timestamp: number;
  content: string;
  isComplete: boolean;
  messageId: string;
}
```

### å®ç”¨æ–¹æ³•

#### ç›´æ¥è°ƒç”¨ LLM

é™¤äº†å®Œæ•´çš„ Agent æµç¨‹ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨å½“å‰é…ç½®çš„ LLMï¼š

```ts
// éæµå¼è°ƒç”¨
const response = await agent.callLLM({
  messages: [
    { role: 'user', content: 'ä½ å¥½' }
  ],
  temperature: 0.5,
});

// æµå¼è°ƒç”¨
const stream = await agent.callLLM({
  messages: [
    { role: 'user', content: 'å†™ä¸€é¦–è¯—' }
  ],
  stream: true,
});

for await (const chunk of stream) {
  process.stdout.write(chunk.choices[0]?.delta?.content || '');
}
```

#### è·å–å¯ç”¨å·¥å…·

```ts
// è·å–æ‰€æœ‰æ³¨å†Œçš„å·¥å…·
const allTools = agent.getTools();

// è·å–ç»è¿‡é’©å­å¤„ç†çš„å¯ç”¨å·¥å…·
const availableTools = await agent.getAvailableTools();

console.log(`å…±æœ‰ ${availableTools.length} ä¸ªå·¥å…·å¯ç”¨`);
```

#### ç”Ÿæˆå¯¹è¯æ‘˜è¦

```ts
const summary = await agent.generateSummary({
  messages: [
    { role: 'user', content: 'ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ' },
    { role: 'assistant', content: 'ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ¸©åº¦ 22Â°Cã€‚' },
  ],
});

console.log(summary.summary); // "å¤©æ°”æŸ¥è¯¢"
```

#### æ‰§è¡Œæ§åˆ¶

```ts
// æ£€æŸ¥ Agent çŠ¶æ€
console.log(agent.status()); // 'idle' | 'running' | 'error'

// è·å–å½“å‰è¿­ä»£æ¬¡æ•°
console.log(agent.getCurrentLoopIteration());

// ä¸­æ­¢æ‰§è¡Œ
if (agent.status() === 'running') {
  agent.abort();
}

// èµ„æºæ¸…ç†
await agent.dispose();
```

### é«˜çº§é…ç½®ç¤ºä¾‹

#### ç”Ÿäº§ç¯å¢ƒé…ç½®

```ts
const productionAgent = new Agent({
  // åŸºç¡€é…ç½®
  name: 'WeatherAssistant',
  id: 'weather-v1.0',
  instructions: `ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å¤©æ°”åŠ©æ‰‹ã€‚è¯·éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š
1. æ€»æ˜¯å…ˆè·å–ç”¨æˆ·ä½ç½®ï¼Œå†æŸ¥è¯¢å¤©æ°”
2. æä¾›è¯¦ç»†ä½†ç®€æ´çš„å¤©æ°”ä¿¡æ¯
3. å¦‚æœæ•°æ®ä¸å‡†ç¡®ï¼Œè¯·è¯´æ˜
4. ç”¨å‹å¥½çš„è¯­æ°”å›å¤`,
  
  // æ¨¡å‹é…ç½®
  model: {
    provider: 'openai',
    id: 'gpt-4o',
    apiKey: process.env.OPENAI_API_KEY!, // ä»ç¯å¢ƒå˜é‡è·å–
  },
  temperature: 0.3, // æ›´ç¡®å®šçš„å›å¤
  maxTokens: 2000,
  
  // å·¥å…·é…ç½®
  tools: [locationTool, weatherTool, alertTool],
  toolCallEngine: 'native',
  tool: {
    exclude: ['dangerousTool'], // æ’é™¤ç‰¹å®šå·¥å…·
  },
  
  // æ‰§è¡Œæ§åˆ¶
  maxIterations: 10, // é™åˆ¶è¿­ä»£æ¬¡æ•°
  context: {
    maxImagesCount: 3, // é™åˆ¶å›¾ç‰‡æ•°é‡
  },
  
  // ç›‘æ§é…ç½®
  logLevel: LogLevel.INFO,
  metric: {
    enable: true, // å¯ç”¨æ€§èƒ½æŒ‡æ ‡
  },
  
  // é«˜çº§é€‰é¡¹
  enableStreamingToolCallEvents: true, // è°ƒè¯•æ¨¡å¼
});
```

#### å¤šæ¨¡å‹åˆ‡æ¢

```ts
// æ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢æ¨¡å‹
const response1 = await agent.run({
  input: "åˆ†æè¿™å¼ å›¾ç‰‡",
  model: {
    provider: 'openai',
    id: 'gpt-4o', // è§†è§‰æ¨¡å‹
  },
});

const response2 = await agent.run({
  input: "ç”Ÿæˆä»£ç ",
  model: {
    provider: 'anthropic',
    id: 'claude-3-5-sonnet-20241022', // ä»£ç ç”Ÿæˆæ¨¡å‹
  },
});
```

#### é”™è¯¯å¤„ç†å’Œé‡è¯•

```ts
try {
  const response = await agent.run({
    input: "ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ",
    // æ·»åŠ è¶…æ—¶æ§åˆ¶
    abortSignal: AbortSignal.timeout(30000),
  });
} catch (error) {
  if (error.name === 'AbortError') {
    console.log('è¯·æ±‚è¶…æ—¶');
  } else {
    console.error('Agent æ‰§è¡Œå¤±è´¥:', error.message);
  }
}
```

### ç”Ÿå‘½å‘¨æœŸé’©å­

`@tarko/agent` æä¾›ä¸°å¯Œçš„é’©å­è®©ä½ è‡ªå®šä¹‰ Agent è¡Œä¸ºï¼š

```ts
class CustomAgent extends Agent {
  async onBeforeToolCall(sessionId, toolCall, args) {
    console.log(`å‡†å¤‡è°ƒç”¨å·¥å…·: ${toolCall.name}`);
    // å¯ä»¥ä¿®æ”¹å‚æ•°
    return { ...args, timestamp: Date.now() };
  }
  
  async onAfterToolCall(sessionId, toolCall, result) {
    console.log(`å·¥å…·è°ƒç”¨å®Œæˆ: ${toolCall.name}`);
    // å¯ä»¥ä¿®æ”¹ç»“æœ
    return result;
  }
  
  async onLLMRequest(sessionId, payload) {
    console.log(`å‘é€ LLM è¯·æ±‚: ${payload.messages.length} æ¡æ¶ˆæ¯`);
  }
}
```

## æœ€ä½³å®è·µ

### ğŸ¯ é€‰æ‹©åˆé€‚çš„å·¥å…·è°ƒç”¨å¼•æ“

```ts
// å¯¹äºæ”¯æŒå‡½æ•°è°ƒç”¨çš„æ¨¡å‹ï¼ˆæ¨èï¼‰
const nativeAgent = new Agent({
  toolCallEngine: 'native', // OpenAIã€Claude ç­‰
});

// å¯¹äºä¸æ”¯æŒå‡½æ•°è°ƒç”¨çš„æ¨¡å‹
const promptAgent = new Agent({
  toolCallEngine: 'prompt_engineering', // å¼€æºæ¨¡å‹
});

// å¯¹äºéœ€è¦ä¸¥æ ¼ç»“æ„åŒ–è¾“å‡ºçš„åœºæ™¯
const structuredAgent = new Agent({
  toolCallEngine: 'structured_outputs',
});
```

### ğŸ”§ å·¥å…·è®¾è®¡åŸåˆ™

```ts
// âœ… å¥½çš„å·¥å…·è®¾è®¡
const goodTool = new Tool({
  id: 'searchWeb',
  description: 'åœ¨ç½‘ç»œä¸Šæœç´¢ä¿¡æ¯ï¼Œè¿”å›ç›¸å…³ç»“æœ',
  parameters: z.object({
    query: z.string().describe('æœç´¢å…³é”®è¯'),
    limit: z.number().default(5).describe('è¿”å›ç»“æœæ•°é‡'),
  }),
  function: async ({ query, limit }) => {
    // å®ç°æœç´¢é€»è¾‘
    return { results: [], total: 0 };
  },
});

// âŒ é¿å…çš„å·¥å…·è®¾è®¡
const badTool = new Tool({
  id: 'doEverything', // åŠŸèƒ½è¿‡äºå®½æ³›
  description: 'åšä»»ä½•äº‹æƒ…', // æè¿°ä¸æ˜ç¡®
  parameters: z.object({
    input: z.any(), // å‚æ•°ç±»å‹ä¸æ˜ç¡®
  }),
  function: async (input) => {
    // é€»è¾‘è¿‡äºå¤æ‚
  },
});
```

### ğŸ“Š æ€§èƒ½ä¼˜åŒ–

```ts
const optimizedAgent = new Agent({
  // é™åˆ¶ä¸Šä¸‹æ–‡å¤§å°
  context: {
    maxImagesCount: 3, // é¿å…ä¸Šä¸‹æ–‡è¿‡å¤§
  },
  
  // åˆç†è®¾ç½®è¿­ä»£æ¬¡æ•°
  maxIterations: 20, // é¿å…æ— é™å¾ªç¯
  
  // å¯ç”¨æ€§èƒ½ç›‘æ§
  metric: {
    enable: true,
  },
  
  // é€‚å½“çš„æ¸©åº¦è®¾ç½®
  temperature: 0.3, // ç”Ÿäº§ç¯å¢ƒæ¨èè¾ƒä½æ¸©åº¦
});
```

### ğŸ›¡ï¸ å®‰å…¨è€ƒè™‘

```ts
// å·¥å…·è¿‡æ»¤
const safeAgent = new Agent({
  tools: [allTools],
  tool: {
    exclude: ['fileDelete', 'systemCommand'], // æ’é™¤å±é™©å·¥å…·
  },
});

// è¾“å…¥éªŒè¯
class SecureAgent extends Agent {
  async onBeforeToolCall(sessionId, toolCall, args) {
    // éªŒè¯å·¥å…·å‚æ•°
    if (toolCall.name === 'fileRead' && args.path.includes('..')) {
      throw new Error('è·¯å¾„éå†æ”»å‡»æ£€æµ‹');
    }
    return args;
  }
}
```

æ›´å¤šé«˜çº§ä½¿ç”¨æ¨¡å¼ï¼Œè¯·å‚é˜… [Agent Hooks æ–‡æ¡£](/guide/advanced/agent-hooks)ã€‚
