# Tool ç®¡ç†

è¿‡æ»¤ã€ç»„ç»‡å’Œä¼˜åŒ– Agent å·¥å…·èƒ½åŠ›ï¼Œé’ˆå¯¹ç‰¹å®šä»»åŠ¡å’Œæ€§èƒ½è¿›è¡Œè°ƒä¼˜ã€‚

## æ¦‚è¿°

@agent-tars/core åŒ…å« **32 ä¸ªå†…ç½®å·¥å…·**ï¼Œåˆ†ä¸º 4 ä¸ªç±»åˆ«ï¼š**general** (1)ã€**browser** (18)ã€**filesystem** (11) å’Œ **commands** (2)ã€‚Tool ç®¡ç†å…è®¸ä½ ç²¾ç¡®æ§åˆ¶å“ªäº›å·¥å…·å¯ç”¨ï¼Œä»¥ä¼˜åŒ–æ€§èƒ½å’Œèšç„¦èƒ½åŠ›ã€‚

## å¿«é€Ÿå¼€å§‹

```bash
# ä»…åŒ…å«æµè§ˆå™¨å·¥å…·ï¼ˆ18 ä¸ªå·¥å…·ï¼‰
tarko --tool.include browser

# åŒ…å«æ–‡ä»¶ç³»ç»Ÿä½†æ’é™¤æ–‡ä»¶ç¼–è¾‘
tarko --tool.include filesystem --tool.exclude edit_file

# å¤šä¸ªç±»åˆ«å¹¶æ’é™¤ç‰¹å®šå·¥å…·
tarko --tool.include "browser,filesystem" --tool.exclude "run_command,run_script"
```

## CLI Tool è¿‡æ»¤

### å¯ç”¨é€‰é¡¹

| é€‰é¡¹ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `--tool.include <patterns>` | åŒ…å«åŒ¹é…æ¨¡å¼çš„å·¥å…· | `--tool.include browser` |
| `--tool.exclude <patterns>` | æ’é™¤åŒ¹é…æ¨¡å¼çš„å·¥å…· | `--tool.exclude delete` |
| `--tool.list` | åˆ—å‡ºæ‰€æœ‰å¯ç”¨å·¥å…· | `--tool.list` |
| `--tool.categories` | æ˜¾ç¤ºå·¥å…·åˆ†ç±» | `--tool.categories` |

### æ¨¡å¼åŒ¹é…è§„åˆ™

- **å­å­—ç¬¦ä¸²åŒ¹é…**ï¼šä½¿ç”¨ `string.includes()` å®ç°é«˜æ€§èƒ½
- **å¤§å°å†™æ•æ„Ÿ**ï¼šæ¨¡å¼å¿…é¡»åŒ¹é…ç¡®åˆ‡çš„å¤§å°å†™ï¼ˆ`browser` è€Œä¸æ˜¯ `Browser`ï¼‰
- **æ‰§è¡Œé¡ºåº**ï¼šå…ˆåº”ç”¨åŒ…å«è¿‡æ»¤å™¨ï¼Œç„¶ååº”ç”¨æ’é™¤è¿‡æ»¤å™¨
- **åˆ†ç±»åç§°**ï¼šä½¿ç”¨åˆ†ç±»åç§°è¿›è¡Œæ‰¹é‡æ“ä½œ

### å¸¸è§ç”¨ä¾‹

#### ä»… Web è‡ªåŠ¨åŒ–
```bash
# æµè§ˆå™¨å·¥å…· + ç½‘ç»œæœç´¢ï¼ˆ19 ä¸ªå·¥å…·ï¼‰
tarko --tool.include "browser,web_search"
```

#### å®‰å…¨æ–‡ä»¶æ“ä½œ
```bash
# æ–‡ä»¶ç³»ç»Ÿä½†ä¸æ‰§è¡Œå‘½ä»¤ï¼ˆ11 ä¸ªå·¥å…·ï¼‰
tarko --tool.include filesystem --tool.exclude "run_command,run_script"
```

#### åªè¯» Agent
```bash
# ä¸å…è®¸æ–‡ä»¶å†™å…¥æˆ–å‘½ä»¤æ‰§è¡Œ
tarko --tool.exclude "write_file,edit_file,create_directory,move_file,run_command,run_script"
```

#### æœ€å°åŒ– Agent
```bash
# ä»…åŸºæœ¬åªè¯»å·¥å…·
tarko --tool.include "read_file,read_multiple_files,list_directory,browser_screenshot,web_search"
```

## ç¼–ç¨‹å¼ Tool ç®¡ç†

### Agent é…ç½®

```typescript
import { Agent } from '@agent-tars/core';

const agent = new Agent({
  tool: {
    include: ['browser', 'filesystem'],
    exclude: ['browser_get_markdown', 'run_command']
  }
});
```

### é…ç½®æ–‡ä»¶

```json
{
  "tool": {
    "include": ["browser", "filesystem"],
    "exclude": ["delete", "remove"],
    "categories": {
      "browser": {
        "enabled": true,
        "exclude": ["browser_get_markdown"]
      },
      "filesystem": {
        "enabled": true,
        "exclude": ["move_file"]
      },
      "commands": {
        "enabled": false
      }
    }
  }
}
```

### åŠ¨æ€ Tool ç®¡ç†

```typescript
import { Agent, ToolManager } from '@agent-tars/core';

const agent = new Agent();
const toolManager = agent.getToolManager();

// è¿è¡Œæ—¶å·¥å…·è¿‡æ»¤
toolManager.filterTools({
  include: ['browser'],
  exclude: ['browser_close_tab']
});

// æ·»åŠ è‡ªå®šä¹‰å·¥å…·
toolManager.addTool(new CustomTool());

// ç§»é™¤ç‰¹å®šå·¥å…·
toolManager.removeTool('browser_get_markdown');

// è·å–æ´»è·ƒå·¥å…·
const activeTools = toolManager.getActiveTools();
console.log(`æ´»è·ƒå·¥å…·: ${activeTools.length}`);
```

## Tool åˆ†ç±»

### å†…ç½®åˆ†ç±»

#### ğŸ“¦ general (1 ä¸ªå·¥å…·)
- `web_search` - æœç´¢ç½‘ç»œä¿¡æ¯

#### ğŸ“¦ browser (18 ä¸ªå·¥å…·)
- `browser_click` - ç‚¹å‡»é¡µé¢å…ƒç´ 
- `browser_close_tab` - å…³é—­æµè§ˆå™¨æ ‡ç­¾é¡µ
- `browser_evaluate` - æ‰§è¡Œ JavaScript ä»£ç 
- `browser_form_input_fill` - å¡«å†™è¡¨å•è¾“å…¥
- `browser_get_clickable_elements` - è·å–å¯ç‚¹å‡»å…ƒç´ 
- `browser_get_markdown` - æå–é¡µé¢å†…å®¹ä¸º markdown
- `browser_go_back` - åœ¨å†å²è®°å½•ä¸­åé€€
- `browser_go_forward` - åœ¨å†å²è®°å½•ä¸­å‰è¿›
- `browser_hover` - æ‚¬åœåœ¨å…ƒç´ ä¸Š
- `browser_navigate` - å¯¼èˆªåˆ° URL
- `browser_new_tab` - æ‰“å¼€æ–°æµè§ˆå™¨æ ‡ç­¾é¡µ
- `browser_press_key` - æŒ‰ä¸‹é”®ç›˜æŒ‰é”®
- `browser_read_links` - æå–æ‰€æœ‰é¡µé¢é“¾æ¥
- `browser_screenshot` - æˆªå–é¡µé¢æˆªå›¾
- `browser_scroll` - æ»šåŠ¨é¡µé¢å†…å®¹
- `browser_select` - é€‰æ‹©ä¸‹æ‹‰é€‰é¡¹
- `browser_switch_tab` - åœ¨æ ‡ç­¾é¡µé—´åˆ‡æ¢
- `browser_tab_list` - åˆ—å‡ºæ‰€æœ‰æ‰“å¼€çš„æ ‡ç­¾é¡µ

#### ğŸ“¦ filesystem (11 ä¸ªå·¥å…·)
- `create_directory` - åˆ›å»ºæ–°ç›®å½•
- `directory_tree` - è·å–ç›®å½•ç»“æ„
- `edit_file` - ç¼–è¾‘ç°æœ‰æ–‡ä»¶
- `get_file_info` - è·å–æ–‡ä»¶å…ƒæ•°æ®
- `list_allowed_directories` - åˆ—å‡ºå¯è®¿é—®ç›®å½•
- `list_directory` - åˆ—å‡ºç›®å½•å†…å®¹
- `move_file` - ç§»åŠ¨æˆ–é‡å‘½åæ–‡ä»¶
- `read_file` - è¯»å–æ–‡ä»¶å†…å®¹
- `read_multiple_files` - ä¸€æ¬¡è¯»å–å¤šä¸ªæ–‡ä»¶
- `search_files` - æŒ‰æ¨¡å¼æœç´¢æ–‡ä»¶
- `write_file` - å†™å…¥å†…å®¹åˆ°æ–‡ä»¶

#### ğŸ“¦ commands (2 ä¸ªå·¥å…·)
- `run_command` - æ‰§è¡Œ shell å‘½ä»¤
- `run_script` - è¿è¡Œè„šæœ¬å’Œè§£é‡Šå™¨

### è‡ªå®šä¹‰åˆ†ç±»

```typescript
import { ToolCategory, Tool } from '@agent-tars/core';

export class DatabaseCategory implements ToolCategory {
  name = 'database';
  description = 'æ•°æ®åº“æ“ä½œå’ŒæŸ¥è¯¢';
  
  tools: Tool[] = [
    new QueryTool(),
    new InsertTool(),
    new UpdateTool(),
    new DeleteTool()
  ];
}

// æ³¨å†Œè‡ªå®šä¹‰åˆ†ç±»
const agent = new Agent({
  toolCategories: [
    new DatabaseCategory()
  ]
});
```

## æ€§èƒ½ä¼˜åŒ–

### Tool åŠ è½½ç­–ç•¥

```typescript
// é‡å‹å·¥å…·çš„æ‡’åŠ è½½
const agent = new Agent({
  tool: {
    loadingStrategy: 'lazy',
    include: ['browser'],
    preload: ['browser_navigate', 'browser_screenshot']
  }
});
```

### å†…å­˜ç®¡ç†

```typescript
// Tool å®ä¾‹æ± 
const agent = new Agent({
  tool: {
    pooling: {
      enabled: true,
      maxInstances: 5,
      idleTimeout: 30000 // 30 ç§’
    }
  }
});
```

### æ‰§è¡Œé™åˆ¶

```typescript
// ä¸ºæ¯ä¸ªå·¥å…·è®¾ç½®æ‰§è¡Œé™åˆ¶
const agent = new Agent({
  tool: {
    limits: {
      'run_command': {
        timeout: 10000, // 10 ç§’
        maxConcurrent: 1
      },
      'browser_screenshot': {
        timeout: 5000,
        maxConcurrent: 3
      }
    }
  }
});
```

## å®‰å…¨å’Œæƒé™

### Tool æƒé™

```typescript
const agent = new Agent({
  tool: {
    permissions: {
      'run_command': {
        allowedCommands: ['ls', 'pwd', 'cat'],
        blockedCommands: ['rm', 'sudo', 'chmod']
      },
      'write_file': {
        allowedPaths: ['/tmp', '/workspace'],
        blockedPaths: ['/etc', '/usr', '/system']
      }
    }
  }
});
```

### æ²™ç®±åŒ–

```typescript
// å¯ç”¨å·¥å…·æ²™ç®±
const agent = new Agent({
  tool: {
    sandbox: {
      enabled: true,
      isolateFileSystem: true,
      isolateNetwork: false,
      allowedDomains: ['api.example.com']
    }
  }
});
```

## ç›‘æ§å’Œåˆ†æ

### Tool ä½¿ç”¨è·Ÿè¸ª

```typescript
import { ToolMonitor } from '@agent-tars/core';

const monitor = new ToolMonitor();

monitor.on('toolExecuted', (event) => {
  console.log(`å·¥å…· ${event.toolName} æ‰§è¡Œè€—æ—¶ ${event.duration}ms`);
});

monitor.on('toolError', (event) => {
  console.error(`å·¥å…· ${event.toolName} å¤±è´¥: ${event.error}`);
});

const agent = new Agent({
  monitor
});
```

### æ€§èƒ½æŒ‡æ ‡

```typescript
// è·å–å·¥å…·æ€§èƒ½æŒ‡æ ‡
const metrics = await agent.getToolMetrics();

console.log('Tool ä½¿ç”¨ç»Ÿè®¡:');
metrics.forEach(metric => {
  console.log(`${metric.toolName}: ${metric.executionCount} æ¬¡è°ƒç”¨ï¼Œå¹³å‡ ${metric.averageDuration}ms`);
});
```

## æ•…éšœæ’é™¤

### è°ƒè¯• Tool è¿‡æ»¤

```bash
# æŸ¥çœ‹å“ªäº›å·¥å…·è¢«è¿‡æ»¤
tarko --debug --tool.include browser
# è¾“å‡º: "åº”ç”¨åŒ…å«è¿‡æ»¤å™¨ï¼Œæ¨¡å¼ [browser]ï¼Œ32/32 å·¥å…·ä¸­åŒ¹é…äº† 18 ä¸ª"
```

### å¸¸è§é—®é¢˜

#### æ²¡æœ‰å¯ç”¨å·¥å…·
```bash
# æ£€æŸ¥å¯ç”¨å·¥å…·
tarko --tool.list

# ä½¿ç”¨æ›´å®½æ³›çš„æ¨¡å¼
tarko --tool.exclude "run_command" # æ’é™¤ç‰¹å®šå·¥å…·è€Œä¸æ˜¯ä¸¥æ ¼åŒ…å«
```

#### æ¨¡å¼ä¸å·¥ä½œ
- éªŒè¯å¤§å°å†™æ•æ„Ÿæ€§ï¼ˆ`browser` è€Œä¸æ˜¯ `Browser`ï¼‰
- ä½¿ç”¨ç¡®åˆ‡çš„å·¥å…·åç§°ï¼ˆ`browser_click` è€Œä¸æ˜¯ `click`ï¼‰
- æ£€æŸ¥åˆ†ç±»åç§°ï¼š`browser`ã€`filesystem`ã€`commands`ã€`general`

#### Tool åŠ è½½é”™è¯¯
```typescript
try {
  const agent = new Agent({
    tool: { include: ['invalid_tool'] }
  });
} catch (error) {
  console.error('å·¥å…·åŠ è½½å¤±è´¥:', error.message);
  // å›é€€åˆ°é»˜è®¤å·¥å…·
}
```

### æ—¥å¿—å’Œè°ƒè¯•

```typescript
import { Agent, LogLevel } from '@agent-tars/core';

const agent = new Agent({
  logging: {
    level: LogLevel.DEBUG,
    categories: ['tool-manager', 'tool-execution']
  }
});
```

## é«˜çº§æ¨¡å¼

### æ¡ä»¶ Tool åŠ è½½

```typescript
const agent = new Agent({
  tool: {
    conditional: {
      'run_command': {
        condition: () => process.env.NODE_ENV === 'development',
        fallback: 'safe_command'
      }
    }
  }
});
```

### Tool ç»„åˆ

```typescript
// å°†å·¥å…·ç»„åˆæˆå·¥ä½œæµ
const workflow = new ToolWorkflow([
  'browser_navigate',
  'browser_screenshot',
  'write_file'
]);

const agent = new Agent({
  workflows: [workflow]
});
```

### æ’ä»¶ç³»ç»Ÿ

```typescript
// ç”¨äºæ‰©å±•æ€§çš„å·¥å…·æ’ä»¶
const toolPlugin = {
  name: 'database-tools',
  version: '1.0.0',
  tools: [
    new QueryTool(),
    new MigrationTool()
  ]
};

const agent = new Agent({
  plugins: [toolPlugin]
});
```

## ä¸‹ä¸€æ­¥

- äº†è§£ [Tool å¼€å‘](/guide/tool/basic) æ¥åˆ›å»ºè‡ªå®šä¹‰å·¥å…·
- æ¢ç´¢ [Tool Call Engine](/guide/tool/tool-call-engine) çš„æ‰§è¡Œä¼˜åŒ–

{/* Placeholder: æ·»åŠ å·¥å…·ç®¡ç†ä»ªè¡¨æ¿æˆªå›¾ */}
{/* Placeholder: æ·»åŠ æ€§èƒ½ç›‘æ§å›¾è¡¨ */}